name: Docker Image CI

on:
  push:
    branches: [ development ]
  pull_request:
    branches: [ development ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Build the Docker image
      run: docker build . --file Dockerfile --tag my-image-name:$(date +%s)
      
- name: action-pdk-validate
  # You may pin to the exact commit or the version.
  # uses: puppets-epic-show-theatre/action-pdk-validate@4536bf103a3c2b92ddee02dfceab99a27ef2e83f
  uses: puppets-epic-show-theatre/action-pdk-validate@v1.1.0
  with:
    # A string indicating the Puppet version to validate against, such as "5.4.2" or "5.5".
    puppet-version: # optional
    # A string indicating the PE version to validate against, such as "2017.3.5" or "2018.1".
    pe-version: # optional
    # A string indicating the docker image to build from, such as "puppet/pdk:latest" or "puppet/pdk:nightly".
    pdk-image: # optional
- name: action-pdk-test-unit
  # You may pin to the exact commit or the version.
  # uses: puppets-epic-show-theatre/action-pdk-test-unit@237550c1eff52a3e457cf4d2d8193fb799823615
  uses: puppets-epic-show-theatre/action-pdk-test-unit@v1.2.0
  with:
    # A string indicating the Puppet version to validate against, such as "5.4.2" or "5.5".
    puppet-version: # optional
    # A string indicating the PE version to validate against, such as "2017.3.5" or "2018.1".
    pe-version: # optional
    # A string indicating the docker image to build from, such as "puppet/pdk:latest" or "puppet/pdk:nightly".
    pdk-image: # optional
    
